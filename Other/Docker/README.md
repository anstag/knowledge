# Docker: как начать и что он даст простому веб-разработчику?
Автор: https://pr-of-it.ru/webinars/93.html  
Ссылка: https://cloud.mail.ru/public/5xCr/2P3jZLB3W

## Что такое Docker? Это программная платформа для:
- надежной изоляции приложений
- управления окружением приложений
- упаковки приложений в контейнеры
- доставки и развертывания приложений

## Сразу к практике

## Первые шаги:

`docker run -it nginx bash`

- docker run - Создание и запуск контейнера
- -it - Опции, говорящие о том, что мы хотим интерактивно взаимодействовать с контейнером (оказаться «внутри» него)
- nginx - Имя образа контейнера. Образ будет скачан из хранилища образов. Образ, по сути – это самостоятельная файловая система.
- bash - Команда, которая должна быть выполнена в запущенном контейнере.

`docker run nginx cat /etc/nginx/nginx.conf`

- docker run - Создание и запуск контейнера
- nginx - Имя образа контейнера
- cat - Команда, которая должна быть выполнена в запущенном контейнере. При этом интерактивности нет, команда выполняется и всё

`docker run -p 8080:80 nginx`

- docker run - Создание и запуск контейнера
- -p 8080:80 - Проброс порта. Порт 80 «изнутри» контейнера становится портом 0.0.0.0:8080 
- Кроме того происходит запуск команды запуска, прописанной в самом контейнере – это, собственно, старт nginx NB: флаг –d запустит команду в фоне

`docker run -p 8080:80 -d nginx` - запуск в фоне
`docker ps` - покажет запущенные контейнеры
`docker ps -a` - все когда либо созданные контейнеры

## Что же такое контейнер?
- Контейнер – это процесс
- Docker запускает этот процесс в изолированном окружении:
	+ Своя сеть
	+ Свой список процессов
	+ Своя файловая система
- Образ – это отдельная виртуальная файловая система, которая "подключается" к контейнеру и процесс работает с ней.

`docker images` - локальные образы

`docker rmi nginx:latest` - удаление образа (разумеется, если нет контейнеров на его базе!)

`docker stats` - информация о потреблении ресурсов

`docker logs ID` - вывод логов из указанного контейнера (-f вывод логов в стиле tail –f)

`docker kill ID` - принудительная остановка указанного контейнера (кроме того: stop, pause, unpause, restart)



## Откуда берутся образы?
### Что такое Docker Hub?
> Это крупнейшая в мире библиотека образов контейнеров и registry (реестр) по умолчанию.

## Найти ее можно по адресу hub.docker.com:
- Публичный репозиторий образов
- Официальные образы от производителей софта
- Семантическое версионирование
- Сертифицированные образы

`docker pull nginx` - Скачиваем образ из официального registry:Docker Hub в свое локальное хранилище

`docker pull myreg:port/my/nginx` - Качаем образ my/nginx из registry по адресу myreg:port

## Взаимодействие контейнера с "внешним миром"
### Как взаимодействовать с контейнером?
`docker run -p 80:80 -p 443:443 nginx` - Проброс портов. Указываем «внешний порт» (на хост-машине) и внутренний (внутри контейнера). В результате контейнер становится доступен по сети.

`docker run -v ~/project:/app nginx`

`docker run -p 8080:80 -v C:\Users\User\Dropbox\docker-test\:/app nginx`

- Проброс папки (или файла) из ФС хостмашины в контейнер
- Путь в ФС должен быть абсолютным
- Если папка (файл) ранее существовали в контейнере – будут заменены

`docker exec -it ID bash` - войти в контейнер

`docker run -e "HOME=/app" nginx` или

`docker run --env-file=.env nginx` - Запуск контейнера с установкой переменных окружения

## Подготовка собственного образа
### Как сделать свой образ?
> Для начала нужно подготовить специальный файл, который называется Dockerfile:
`FROM php:7.3-cli
MAINTAINER UserName <user@true.ru>

RUN apt update && apt install -y mc

COPY . /app
WORKDIR /app`

- Обязательно указываем образ, от которого наследуемся
- RUN - Выполняет определенные нами команды при сборке образа (создает слой)
- COPY Копирует указанные папки или файлы внутрь образа
- WORKDIR Установка стартовой директории для процесса

`docker build . -t "name:tag"`

`docker build .` - Собирает контейнер и помещает его в registry

## DOCKER-COMPOSE
### Что такое Docker Compose?











1:11